#!/bin/bash
# vim:set ft=sh:

VERSION={{ .nerdfontVersion }}

TARGET="$HOME"/.local/share/fonts/
[ -d "$TARGET" ] || mkdir -p "$TARGET"

CASCADIA=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/CascadiaCode.zip
IBMPLEX=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/IBMPlexMono.zip
FIRA=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/FiraCode.zip
HACK=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/Hack.zip
INCONSOLATA=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/Inconsolata.zip
IOSEVKA=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/Iosevka.zip
JETBRAINS=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/JetBrainsMono.zip
OVERPASS=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/Overpass.zip
SOURCECODEPRO=https://github.com/ryanoasis/nerd-fonts/releases/download/v${VERSION}/SourceCodePro.zip

arr=("$CASCADIA" "$IBMPLEX" "$FIRA" "$HACK" "$INCONSOLATA" "$IOSEVKA" "$JETBRAINS" "$OVERPASS" "$SOURCECODEPRO")

SRC=/tmp/font.zip
DST=/tmp/fonts

# just a cleanup if its present
rm -rf "$SRC" "$DST"

for url in "${arr[@]}"; do
    echo "--> setting $url"
    wget -q --show-progress --progress=bar:force 2>&1 "$url" -O "$SRC"
	unzip -q "$SRC" -d "$DST"
	mv "$DST"/*.ttf "$TARGET"
    find "$DST" -type f -name "*.ttf" -exec mv {} "$TARGET" \;
    rm -rf "$SRC" "$DST"
done

echo "--> Setting all-the-icons fonts"
git clone --depth 1 https://github.com/domtronn/all-the-icons.el /tmp/all-the-icons
find /tmp/all-the-icons/fonts -type f -name "*.ttf" -exec mv {} "$TARGET" \;
rm -rf /tmp/all-the-icons

echo "--> updating fonts cache"
fc-cache -f
