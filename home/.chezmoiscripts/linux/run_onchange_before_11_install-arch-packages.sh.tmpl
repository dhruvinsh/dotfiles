#!/usr/bin/env bash
set -euo pipefail

# if arch based system
{{- if lookPath "pacman" }}
# desktop environment package
packages=(
    inotify-tools
    lightdm
    lightdm-gtk-greeter
    picom
    pulseaudio
    rofi  # or dmenu
    xf86-video-intel # I know I will be using it on laptop
    xmonad
    xmonad-contrib
    xorg-server
    xorg-xinit
)
# some usefule packages
packages+=(
    aspell
    ca-certificates
    curl
    direnv
    dunst
    fd
    ffmpegthumbnailer
    firefox
    fontconfig
    fzf
    git
    gnupg
    graphviz
    htop
    imagemagick
    jq
    kitty
    light
    mpc
    mpd
    mpv
    ncmpcpp
    neovim
    ranger
    ranger
    ripgrep
    scrot
    shellcheck
    sqlite
    stylua
    tar
    tmux
    unzip
    wget
    xclip
    zathura
    zathura-pdf-mupdf
    zsh
)

# python build packages
# Arch linux does supports latest python but I will stick to pyenv
packages+=(
    base-devel
    openssl
    tk
    xz
    zlib
)
# aur packages
packages_aur=(
    cava
    i3lock-color
)

{{ if eq .emacs true }}
# for arch linux emacs-nativecomp is available
packages+=(
    emacs-nativecomp
)
{{ end -}}

# install all the packages
sudo pacman -S --noconfirm --needed ${packages[@]}

echo "XDG-Dir setups"
xdg-user-dirs-update

# some variable
echo "local bin directory setup"
LOCALBIN=$HOME/.local/bin
[ -d "$LOCALBIN" ] && echo "directory exists" || mkdir -p $LOCALBIN

echo "set ZSH to default"
if [ "$SHELL" != "/usr/bin/zsh" ]; then
    sudo chsh -s $(which zsh) $USER
fi


echo "YAY installation"
if [ -x "$(command -v yay)" ] ; then
     echo "Yay Already Installed"
else
    git clone https://aur.archlinux.org/yay-git.git ~/Downloads/yay-git
    cd ~/Downloads/yay-git
    makepkg -si
    cd ~
sudo yay -S ${packages_aur[@]}
{{- end }}
